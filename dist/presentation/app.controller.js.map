{"version":3,"sources":["../../src/presentation/app.controller.ts"],"sourcesContent":["import { Controller, Get, Next, Post, Req, Res } from '@nestjs/common';\nimport {\n  ApiBody,\n  ApiOperation,\n  ApiUnauthorizedResponse,\n} from '@nestjs/swagger';\nimport { PostGraphileResponseNode } from 'postgraphile';\n\nimport { AppScenario } from '../application/scenario/app.scenario';\n\nimport { middleware } from './middleware';\n\nimport type { Request, Response } from 'express';\n\n@Controller()\nexport class AppController {\n  constructor(private readonly appScenario: AppScenario) {}\n\n  @Get()\n  healthCheck(): string {\n    return this.appScenario.getHello();\n  }\n\n  @Get(middleware.graphiqlRoute)\n  @ApiOperation({\n    summary: 'GraphiQL UI',\n    description: `GraphQLを確認するためのUIを提供します。\n\nクエリの確認や実行が可能です。\n\nNODE_ENV=localの場合のみ有効です。`,\n  })\n  graphiql(\n    @Req() request: Request,\n    @Res() response: Response,\n    @Next() next: (e?: 'route' | Error) => void,\n  ) {\n    middleware.graphiqlRouteHandler?.(\n      new PostGraphileResponseNode(request, response, next),\n    );\n  }\n\n  @Post(middleware.graphqlRoute)\n  @ApiOperation({\n    summary: 'GraphQL Endpoint',\n    description: `GraphQLエンドポイントです。`,\n  })\n  @ApiBody({\n    type: Object,\n    description: `GraphQLのクエリを指定します。`,\n  })\n  @ApiUnauthorizedResponse({\n    description: '認証エラー',\n  })\n  graphql(\n    @Req() request: Request,\n    @Res() response: Response,\n    @Next() next: (e?: 'route' | Error) => void,\n  ) {\n    middleware.graphqlRouteHandler(\n      new PostGraphileResponseNode(request, response, next),\n    );\n  }\n}\n"],"names":["Controller","Get","Next","Post","Req","Res","ApiBody","ApiOperation","ApiUnauthorizedResponse","PostGraphileResponseNode","AppScenario","middleware","AppController","healthCheck","appScenario","getHello","graphiql","request","response","next","graphiqlRouteHandler","graphql","graphqlRouteHandler","constructor","graphiqlRoute","summary","description","graphqlRoute","type","Object"],"mappings":";;;;;;;;;;;;;;AAAA,SAASA,UAAU,EAAEC,GAAG,EAAEC,IAAI,EAAEC,IAAI,EAAEC,GAAG,EAAEC,GAAG,QAAQ,iBAAiB;AACvE,SACEC,OAAO,EACPC,YAAY,EACZC,uBAAuB,QAClB,kBAAkB;AACzB,SAASC,wBAAwB,QAAQ,eAAe;AAExD,SAASC,WAAW,QAAQ,0CAAuC;AAEnE,SAASC,UAAU,QAAQ,wBAAe;AAK1C,OAAO,MAAMC;IAIXC,cAAsB;QACpB,OAAO,IAAI,CAACC,WAAW,CAACC,QAAQ;IAClC;IAWAC,SACE,AAAOC,OAAgB,EACvB,AAAOC,QAAkB,EACzB,AAAQC,IAAmC,EAC3C;QACAR,WAAWS,oBAAoB,GAC7B,IAAIX,yBAAyBQ,SAASC,UAAUC;IAEpD;IAcAE,QACE,AAAOJ,OAAgB,EACvB,AAAOC,QAAkB,EACzB,AAAQC,IAAmC,EAC3C;QACAR,WAAWW,mBAAmB,CAC5B,IAAIb,yBAAyBQ,SAASC,UAAUC;IAEpD;IA9CAI,YAAY,AAAiBT,WAAwB,CAAE;aAA1BA,cAAAA;IAA2B;AA+C1D;;;;;;;;mBAxCkBU;;QAEdC,SAAS;QACTC,aAAa,CAAC;;;;wBAIM,CAAC;;;;;;;;;;;;;;oBAYNC;;QAEfF,SAAS;QACTC,aAAa,CAAC,iBAAiB,CAAC;;;QAGhCE,MAAMC;QACNH,aAAa,CAAC,kBAAkB,CAAC;;;QAGjCA,aAAa"}